# Ansible Playbook для развертывания Calibre Server

## Описание

Этот Ansible Playbook автоматизирует развертывание Calibre Server на системах, основанных на Ubuntu. Он обеспечивает установку необходимых зависимостей, настройку сервера, конфигурацию брандмауэра и создание systemd-сервиса для управления Calibre Server.

## Возможности

- Устанавливает необходимые зависимости.
- Загружает и устанавливает Calibre.
- Создаёт отдельного пользователя `calibre`.
- Конфигурирует директорию библиотеки Calibre.
- Проверяет существование библиотеки Calibre и инициализирует её при необходимости.
- Открывает необходимые порты в брандмауэре.
- Создаёт и управляет systemd-сервисом для Calibre Server.

## Требования

- Установленный Ansible на управляющем узле.
- Целевая система на базе Ubuntu[`22`].
- SSH-доступ к целевой системе.
- Права sudo на целевой системе.

## Установка

### 1. Настройка переменных

Обновите файл `vars/calibre.yml`, указав необходимые параметры:

```yaml
calibre_user: calibre
calibre_service: calibre-server
```

### 2. Запуск Playbook

Выполните команду:

```sh
ansible-playbook -i inventory deploy-calibre.yml
```

Где `inventory` — ваш инвентарь с целевыми хостами.

## Настройка

Вы можете изменить настройки брандмауэра, изменив переменную `firewall_ports` и `firewall-service` в файле конфигурации роли.

## Systemd-сервис

Playbook создаёт systemd-сервис для Calibre Server, используя шаблон `templates/calibre.service.j2`. Если требуется изменить поведение сервиса, обновите этот файл.
